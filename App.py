# app.py
import random
import textwrap
import streamlit as st

st.set_page_config(page_title="ë¬¸í•™ ì¸ìš©êµ¬ ì¶”ì²œê¸°", page_icon="ðŸ“š", layout="centered")

# -----------------------------
# ê°ì • ì„ íƒì§€ í™•ìž¥
# -----------------------------
ALL_EMOTIONS = [
    "ê¸°ì¨","ì¦ê±°ì›€","í¬ë§","ì„¤ë ˜","ê°ë™","ê°ì‚¬","ì‚¬ëž‘","í‰ì˜¨","ë§Œì¡±","ì—´ì •","ìžë¶€ì‹¬","í¥ë¯¸",
    "ìŠ¬í””","ê·¸ë¦¬ì›€","ì™¸ë¡œì›€","í—ˆë¬´","ë¶„ë…¸","ë¶ˆì•ˆ","ê³µí¬","ì£„ì±…ê°","í›„íšŒ","ì ˆë§","í˜¼ëž€","ì¢Œì ˆ",
    "í–¥ìˆ˜","ë†€ëžŒ","ê²½ì™¸","ì—°ë¯¼","ìœ„ë¡œ","ì„±ì°°","ê²°ì˜","ê¸°ëŒ€","ì§€ë£¨í•¨","í•´ë°©ê°"
]

# -----------------------------
# ê°„ë‹¨í•œ ì˜ˆì‹œ ë°ì´í„° (ì‹¤ì œ ì‚¬ìš© ì‹œ ë” ë§Žì´ ì¶”ê°€)
# -----------------------------
QUOTES = [
    {"text": "ì£½ëŠ” ë‚ ê¹Œì§€ í•˜ëŠ˜ì„ ìš°ëŸ¬ëŸ¬ í•œ ì  ë¶€ë„ëŸ¼ì´ ì—†ê¸°ë¥¼...", "author": "ìœ¤ë™ì£¼", "work": "ì„œì‹œ", "era": "í˜„ëŒ€ì‹œ", "emotion": ["í¬ë§","ì„±ì°°"]},
    {"text": "ë‚˜ ë³´ê¸°ê°€ ì—­ê²¨ì›Œ ê°€ì‹¤ ë•Œì—ëŠ” ë§ì—†ì´ ê³ ì´ ë³´ë‚´ ë“œë¦¬ì˜¤ë¦¬ë‹¤.", "author": "ê¹€ì†Œì›”", "work": "ì§„ë‹¬ëž˜ê½ƒ", "era": "í˜„ëŒ€ì‹œ", "emotion": ["ê·¸ë¦¬ì›€","ìŠ¬í””"]},
    {"text": "ë°¤ì´ ê¹Šì„ìˆ˜ë¡ ë³„ì€ ë” ë˜ë ·í•˜ë‹¤.", "author": "ì†ë‹´", "work": "ë¯¼ê°„ì–´ë¡", "era": "í†µì†", "emotion": ["ìœ„ë¡œ","í¬ë§"]},
    {"text": "ê½ƒì´ í”¼ë©´ ì§€ëŠ” ê²ƒì´ ìžì—°ì˜ ì´ì¹˜ê±°ëŠ˜, ì§€ëŠ” ê²ƒ ë˜í•œ ê½ƒì´ë‹ˆ ì„œëŸ¬ì›Œ ë§ì§€ì–´ë‹¤.", "author": "ê³ ì „ ì–´êµ¬", "work": "ê³ ì „ ì •ì„œ", "era": "ê³ ì „", "emotion": ["í—ˆë¬´","ìœ„ë¡œ"]},
]

# -----------------------------
# í•¨ìˆ˜
# -----------------------------
def pick_quotes(emotion: str):
    cand = [q for q in QUOTES if emotion in q["emotion"]]
    random.shuffle(cand)
    return cand

def format_quote(q):
    wrapped = textwrap.fill(q["text"], width=30)
    meta = f"â€” {q['author']} ã€ˆ{q['work']}ã€‰ Â· {q['era']}"
    return wrapped, meta

# -----------------------------
# ë©”ì¸ í™”ë©´
# -----------------------------
st.title("ðŸ“š ë¬¸í•™ ì¸ìš©êµ¬ ì¶”ì²œê¸°")
st.caption("ê°ì •ì„ ì„ íƒí•˜ë©´ ê·¸ ì •ì„œì™€ ì–´ìš¸ë¦¬ëŠ” ë¬¸í•™ êµ¬ì ˆì„ ì¶”ì²œí•©ë‹ˆë‹¤.")

# âœ… ê°ì •ì„ ê°ê´€ì‹ ì„ íƒ (ë“œë¡­ë‹¤ìš´ìœ¼ë¡œ í™•ìž¥)
chosen_emotion = st.selectbox("ê°ì •ì„ ì„ íƒí•˜ì„¸ìš”", ALL_EMOTIONS)

st.subheader(f"âœ¨ {chosen_emotion}ì— ì–´ìš¸ë¦¬ëŠ” êµ¬ì ˆ")

pool = pick_quotes(chosen_emotion)

if not pool:
    st.info("í•´ë‹¹ ê°ì •ê³¼ ì§ì ‘ ì—°ê²°ëœ ì¸ìš©êµ¬ê°€ ì—†ì–´ ë¬´ìž‘ìœ„ ì¶”ì²œì„ ë“œë¦½ë‹ˆë‹¤.")
    q = random.choice(QUOTES)
else:
    q = random.choice(pool)

wrapped, meta = format_quote(q)
st.markdown(f"> {wrapped}")
st.caption(meta)
